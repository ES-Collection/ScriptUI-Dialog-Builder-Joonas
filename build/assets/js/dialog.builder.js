function breadCrumbs(e,t){e.find(".active-parent").removeClass("active-parent"),t.parentsUntil(".dialog.tree-root").filter('[data-parent="true"]').addClass("active-parent")}function lightThePath(e,t){if($(".path-node").removeClass("path-node"),$(".path-item").removeClass("path-item"),$(".path-sibling-node").removeClass("path-sibling-node"),$(".path-end").removeClass("path-end"),$(".path-start").removeClass("path-start"),$(".path-start-last").removeClass("path-start-last"),$(".path-start-node").removeClass("path-start-node"),$(".path-parent-ul").removeClass("path-parent-ul"),"Dialog"!==t.data("item-type")&&!t.parent().parent().hasClass("tree-root")){e.find(".active-parent").first().addClass("path-end");var a=t;a.next().length<1?a.addClass("path-start-last"):a.data("parent")?a.addClass("path-start-node"):a.addClass("path-start"),e.find(".active-parent:not(:first)").addClass("path-node").add(a).each(function(){$(this).prevUntil(":first").each(function(){$(this).data("parent")?($(this).addClass("path-sibling-node"),$(this).parent("ul").addClass("path-parent-ul")):$(this).addClass("path-item")})})}}function droplistOnWindowResize(){$(window).on("resize",function(){droplist.hide()})}function numberInputs(){function e(e,i,n,s){var l=e.val(),r=parseInt(l.replace(/\D/g,""),10);r=r||0;var d=$("#dialog .active"),o=e.hasClass("width"),c=e.hasClass("height"),p={min:parseInt(e.attr("min"),10),max:parseInt(e.attr("max"),10),step:s||parseInt(e.attr("step"),10),modifierStep:parseInt(e.attr("modifier-step"),10)},m=(n?p.modifierStep:p.step)||1,g=r<p.min,u=r>p.max,f=g||u;if(a){if(a=!1,o)r=Math.round(d.width())+("down"===i?1:0)-("up"===i?1:0);else if(c){var v="Dialog"===$("#dialog .active").data("item-type")?d.find("> .padding-box").outerHeight():d.height();r=Math.round(v)+("down"===i?1:0)-("up"===i?1:0)}}else l!==r.toString()?e.val(r):r||e.val(0);switch(i){case"up":r<p.max&&(r=r+m>p.max?p.max:r+m,e.val(r),t=r);break;case"down":r>p.min&&(r=r-m<p.min?p.min:r-m,e.val(r),t=r);break}if(f){var h=g&&p.min||u&&p.max;e.val(h)}item.funnel.update(e.data("edit"))}$(".number").wrap('<div class="number-wrap">');var t,a,i=$(".number-wrap");$('<div class="arrow plus"></div><div class="arrow minus"></div><div class="number-overlay"></div>').appendTo(i);var n=i.find(".number"),s=i.find(".number-overlay");n.each(function(){"none"===$(this).css("display")&&$(this).closest(".number-wrap").addClass("hide")});var l,r,d=!1,o=0,c=null,p=null;$(window).on("mousedown mousemove mouseup",function(i){if("mousedown"===i.type)d=!0,l=$(i.target).parent(),r=l.find("> .number"),t=r.val(),a=0==t;else if("mousemove"===i.type){if(d&&mousemovePing&&r.hasClass("number")){if(mousemovePing=!1,i.preventDefault(),null===c)return c=Date.now(),void(p=i.screenY);var n=Date.now(),s=n-c,m=i.screenY-p,g=Math.abs(Math.round(m/s*(i.shiftKey?200:40))),u=g>4?g:0;c=n,p=i.screenY,i.pageY<o?e(r,"up",i.shiftKey,u):i.pageY>o&&e(r,"down",i.shiftKey,u),o=i.pageY}}else if("mouseup"===i.type){d&&r.length;d=!1}}),s.on("click",function(){$(this).parent().find(".number").focus()}),n.on("focus blur",function(i){var n=$(this);"focus"===i.type?(t=n.val(),a=0==t,$(this).select()):e(n,"blur")}),i.find(".arrow").on("click",function(i){var n=$(this),s=n.parent().find(".number");t=s.val(),a=0==t,n.hasClass("plus")?e(s,"up",i.shiftKey):n.hasClass("minus")&&e(s,"down",i.shiftKey)}),n.on("keyup",function(i){var n=i.keyCode?i.keyCode:i.which,s=$(this);t=s.val(),a=0==t,e(s,38===n?"up":40===n?"down":"numberEntry",i.shiftKey)}),s.on("wheel",function(i){var n=i.originalEvent.deltaY,s=i.originalEvent.deltaX,l=n<0||s<0,r=$(this).parent().find(".number");t=r.val(),a=0==t,e(r,l?"up":"down",i.shiftKey)})}function exportCode(){var e=local_storage.get("dialog");return"/* \nCode for Import https://scriptui.joonas.me â€” (Triple click to select): \n"+JSON.stringify(e)+"\n*/ \n\n"+getJSX(e)}function clipBoardEvent(e){var t=new ClipboardJS(".btn.copy",{text:function(){return e.getValue()}});t.on("success",function(e){var t=$(e.trigger),a=t.find(".fa-check"),i=t.find(".fa-clipboard-list");a.addClass("rotateIn"),i.hide(),setTimeout(function(){a.removeClass("rotateIn"),i.show()},750)}),t.on("error",function(t){var a=$(t.trigger),i=a.find(".fa-times"),n=a.find(".fa-clipboard-list");i.addClass("tada"),n.hide(),setTimeout(function(){e.execCommand("selectAll"),i.removeClass("tada"),n.show()},750)})}function getJSX(e){var t="",a={},i={dialog:"",tab:""},n={name:"",parent:""},s=[];$('[data-panel="treeview"] ul li').each(function(){var t=$(this).data("item-id"),a=$(this).data("item-type"),n=e.items["item-"+t].style.varName;n?i[n.toLowerCase()]=-1:i[a.toLowerCase()]=0});var l=$("#panel-tree-view-wrap .tree-dialog li"),r=l.length;return l.each(function(l){var d=l,o=$(this).data().itemId,c=e.items["item-"+o],p=c.parentId,m=0===p||!1===p?"Dialog":e.items["item-"+p].type,g=c.type,u=c.id,f=c.style,v=!1;l===r-1&&(v=!0),t+=makeJSXitem(d,e,i,a,g,u,p,m,f,n,s,v)}),t}function customVarNames(e,t,a,i){var n;if(e.varName){var s=i[e.varName.toLowerCase()];n=e.varName+(s>0?s:"")}else switch(t){case"dropdownlist":n="dropdown"+i[t];break;case"tabbedpanel":n="tpanel"+i[t];break;case"dialog":n=t;break;default:n=t+i[t]}return n}function makeJSXitem(e,t,a,i,n,s,l,r,d,o,c,p){var m=[!1],g="",u=n.toLowerCase();d.varName?++a[d.varName.toLowerCase()]:++a[u];var f=customVarNames(d,u,r,a);i[s]=f;var v=i[l];"TreeItem"!==n&&(item.list[n.toLowerCase()](!1).parent?(g+="// "+f.toUpperCase()+"\n",g+="// "+Array(f.length+1).join("=")+"\n"):o.parent!==v&&o.name!==v&&(g+="// "+v.toUpperCase()+"\n",g+="// "+Array(v.length+1).join("=")+"\n"));var h=$("#dialog");switch(n){case"Dialog":g+="var "+f+' = new Window("'+u+'"); \n';break;case"ListBox":case"DropDownList":var b=d.listItems.split("\n").join("").split(",");$.each(b,function(e){b[e]=b[e].trim()}),g+="var "+f+'_array = ["'+b.join('","')+'"]; \n',g+="var "+f+" = "+i[l]+'.add("'+u+'", undefined, '+f+"_array",void 0!==d.selection&&"ListBox"===n&&d.selection.length>1&&(g+=", {multiselect: true}"),g+="); \n";break;case"Divider":g+="var "+f+" = "+i[l]+'.add("panel"); \n';break;case"TreeView":var y=h.find('[data-item-id="'+s+'"]'),w=d.preferredSize[0]>0?d.preferredSize[0]:Math.round(y.width()),C=d.preferredSize[1]>0?d.preferredSize[1]:Math.round(y.height());g+="var "+f+" = "+i[l]+'.add("'+n.toLowerCase()+'", [0,0,'+(w+0)+","+(C+0)+"]); \n";break;case"TreeItem":var x=h.find('[data-item-id="'+s+'"]').hasClass("tree-node")?"node":"item";g+="var "+f+" = "+i[l]+'.add("'+x+'", "'+d.text+'"); \n';break;case"StaticText":if((m=multilineCheck(s))[0]){if(g+="var "+f+" = "+i[l]+'.add("group"); \n',void 0!==d.preferredSize&&(d.preferredSize[0]>0&&(g+="    "+f+".preferredSize.width = "+d.preferredSize[0]+"; \n"),d.preferredSize[1]>0&&(g+="    "+f+".preferredSize.height = "+d.preferredSize[1]+"; \n")),g+="    "+f+'.orientation = "column"; \n',void 0!==d.justify&&(g+="    "+f+'.alignChildren = ["'+d.justify+'","center"]; \n'),g+="    "+f+".spacing = 0; \n",null!=d.alignment){var I=t.items["item-"+l].style.orientation,k="";k="column"===I?("top"===d.alignment?"left":"bottom"===d.alignment&&"right")||d.alignment:("left"===d.alignment?"top":"right"===d.alignment&&"bottom")||d.alignment;var S=t.items["item-"+l].style.alignChildren;k="column"===I?'["'+k+'","'+S[1]+'"]':'["'+S[0]+'","'+k+'"]',g+="    "+f+".alignment = "+k+"; \n"}g+="\n";var T=m[1].split("<br>");$.each(T,function(e,t){g+="    "+f+'.add("statictext", undefined, "'+t+'"); \n'})}else g+="var "+f+" = "+i[l]+'.add("'+u+'"); \n';break;case"EditText":m=multilineCheck(s);var z=$('#dialog [data-item-id="'+s+'"]'),P=Math.round(z.width()),_=Math.round(z.height()),D=m[0]?", [0,0, "+P+", "+_+" ], undefined, {multiline: true}":"";g+="var "+f+" = "+i[l]+'.add("'+u+'"'+D+"); \n";break;case"Image":g+="var "+f+'_array = ["'+encodeURIComponent(atob(d.image[0].split(",")[1].replace(/=$/,"").replace(/=$/,"")))+'"]; \n',g+="var "+f+" = "+i[l]+'.add("image", undefined, File.decode('+f+"_array[0]) ); \n";break;default:g+="var "+f+" = "+i[l]+'.add("'+u+'"); \n'}o.name=f,o.parent=i[l];var j="TreeItem"!==n||p?"\n":"";g+=styleJSXitem(t,a,i,n,s,l,r,d,f,c,m,"    ")+j;var A=t.order[e+1];if(void 0!==A){var L=t.items["item-"+A],N="TreeItem"===n&&"TreeItem"!==L.type;N&&c.length>0?(g+="\n",$.each(c,function(e,t){g+=t}),g+="\n",c=[]):N&&(g+="\n")}else void 0===A&&"TreeItem"===n&&($.each(c,function(e,t){g+=t}),g+="\n",c=[]);"Tab"===n&&(s===$('#dialog [data-item-id="'+l+'"] > .tab-container .tab:last').data("tab-id")&&(g+="// "+v.toUpperCase()+"\n",g+="// "+Array(v.length+1).join("=")+"\n",g+=i[l]+".selection = "+i[t.items["item-"+l].style.selection]+"; \n\n"));return p&&(g+=i[0]+".show();"),g}function multilineCheck(e){var t=!1,a=[],i=$('#dialog [data-item-id="'+e+'"] .text-container'),n=i.html();i.width(i.width());var s=n.replace(/<br>$/,"").split(" ");return i.html(""),$.each(s,function(e,n){var s=n.split("<br>");if(s.length>1)t=!0,$.each(s,function(e,t){var n=e===s.length-1;i.html(i.html()+(n?"":" ")+t+(n?"":"<br>")),a.push((n?"":" ")+t+(n?"":"<br>"))});else{var l=i.height(),r=0===e?"":" ";i.html(i.html()+r+n),l<i.height()?(a.push(n),t=!0,a.splice(a.length-1,0,"<br>")):a.push(r+n)}}),i.width(""),i.html(n),[t,a.join("")]}function styleJSXitem(e,t,a,i,n,s,l,r,d,o,c,p){var m="";if("TreeItem"===i){var g=e.items["item-"+n].expanded,u=$('#dialog [data-item-id="'+n+'"]').parentsUntil(".tree-view").filter(".tree-view-item"),f=!1;$.each(u,function(){$(this).hasClass("expanded")||(f=!0)}),g&&!1===f&&o.push(p+d+".expanded = true; \n")}else if("Divider"===i)m+=p+d+'.alignment = "fill"; \n';else if("Slider"===i)m+=p+d+".minvalue = 0; \n",m+=p+d+".maxvalue = 100; \n",m+=p+d+".value = 50; \n";else{if("DropDownList"===i&&void 0!==r.selection&&(m+=p+d+".selection = "+r.selection+"; \n"),"ListBox"===i&&void 0!==r.selection&&r.selection.length>0)m+=p+d+".selection = "+(r.selection.length>1?JSON.stringify(r.selection):r.selection)+"; \n";if("TabbedPanel"===i&&(m+=p+d+'.alignChildren = "fill"; \n'),void 0!==r.text&&r.text.length>0)if("StaticText"===i&&!c[0]||"StaticText"!==i)m+=p+d+'.text = "'+("EditText"===i&&c[0]?r.text.split("\n").join("\\r"):r.text)+'"; \n';if(!0===r.checked&&(m+=p+d+".value = "+r.checked+"; \n"),"TabbedPanel"===i&&0===r.preferredSize[0])m+=p+d+".preferredSize.width = 1; // A trick for != Photoshop \n";else if(void 0!==r.preferredSize&&"TreeView"!==i){var v=r.preferredSize[0],h=r.preferredSize[1];"EditText"===i&&c[0]||(v>0&&(m+=p+d+".preferredSize.width = "+v+"; \n"),h>0&&(m+=p+d+".preferredSize.height = "+h+"; \n"))}if(void 0!==r.justify&&"left"!==r.justify||"Button"===i&&"center"!==r.justify)if(!c[0]&&"StaticText"!==i)m+=p+((void 0===r.text?0:r.text.indexOf("\n"))>0?"// ":"")+d+'.justify = "'+r.justify+'"; \n';if(void 0!==r.orientation&&(m+=p+d+'.orientation = "'+r.orientation+'"; \n'),void 0!==r.alignChildren&&(m+=p+d+'.alignChildren = ["'+r.alignChildren[0]+'","'+r.alignChildren[1]+'"]; \n'),void 0!==r.spacing&&(m+=p+d+".spacing = "+r.spacing+"; \n"),void 0!==r.margins&&"TabbedPanel"!==i)m+=p+d+".margins = "+("object"==typeof r.margins?"["+r.margins[3]+","+r.margins[0]+","+r.margins[1]+","+r.margins[2]+"]":r.margins)+"; \n";else if("Tab"===i&&void 0!==e.items["item-"+s].style.margins){var b=e.items["item-"+s].style.margins;m+=p+d+".margins = "+("object"==typeof b?"["+b[3]+","+b[0]+","+b[1]+","+b[2]+"]":b)+"; \n"}else"TabbedPanel"===i&&(m+=p+d+".margins = 0; \n");if(null!=r.alignment&&!c[0]){var y=e.items["item-"+s].style.orientation,w="";w="column"===y?("top"===r.alignment?"left":"bottom"===r.alignment&&"right")||r.alignment:("left"===r.alignment?"top":"right"===r.alignment&&"bottom")||r.alignment;var C=e.items["item-"+s].style.alignChildren;m+=p+d+".alignment = "+(w="column"===y?'["'+w+'","'+C[1]+'"]':'["'+C[0]+'","'+w+'"]')+"; \n"}}return m}function resetDialog(){modal.init('<div id="reset-box"><h2>Delete Dialog.jsx</h2><span class="text">This will delete the dialog, <br /> allowing you to start over from a clean slate.</span><span class="yes" data-enter>Delete</span><span class="no">Cancel</span></div>');var e=$("#reset-box");e.find(".yes").on("click",function(){modal.remove(),setTimeout(function(){local_storage.remove("dialog"),loadingScreen.init(null,function(){location.reload()})},300)}),e.find(".no").on("click",function(){modal.remove()})}function notification(e,t,a){function i(e){e.addClass("fadeOut"),setTimeout(function(){e.remove()},300)}var n=$('<div class="notification '+e+' animated"><div><i class="fas fa-info-circle icon"></i><div class="msg">'+t+"<div></div></div>").appendTo("#notifications-wrap"),s=$("#notifications-wrap .notification").length;s>=1&&i($("#notifications-wrap .notification").slice(0,s-1));var l=n.height();n.css({height:0,visibility:"visible"}),n.animate({height:l},300,"easeInOutBack"),$("#notifications-wrap .notification:last").addClass("last").prev().removeClass("last"),setTimeout(function(){i(n)},1e3*a||5e3)}function shortcutExport(){var e=new ClipboardJS(".l-export",{text:function(){return exportCode()}}),t=$(".l-export");e.on("success",function(){clearTimeout(bgTimeout),t.addClass("success"),$("body").addClass("successful-shortcut-export"),bgTimeout=setTimeout(function(){t.removeClass("success"),$("body").removeClass("successful-shortcut-export")},350),clearTimeout(iconTimeout),$("#dialog-section #export-success-icon").remove(),$('<div id="export-success-icon"><div class="center-1"><div class="center-2"><div class="center-3"><div class="circle"><img src="assets/images/export-shortcut-icon.svg?'+(new Date).getTime()+'" alt="" /></div></div></div></div></div>').appendTo("#dialog-section"),iconTimeout=setTimeout(function(){$("#export-success-icon").remove()},950)}),e.on("error",function(){t.addClass("failure"),$("body").addClass("shortcut-export-failure"),setTimeout(function(){t.removeClass("failure"),$("body").removeClass("shortcut-export-failure")},350)})}function lineBreakIntercept(e){var t=e.keyCode?e.keyCode:e.which,a=$("#panel-tree-view-wrap .active").data("item-type"),i=item.list[a.toLowerCase()](!1).multiline;return!(13===t&&!i)}var local_storage={set:function(e,t){localStorage.setItem(e,JSON.stringify(t))},get:function(e){return JSON.parse(localStorage.getItem(e))},remove:function(e){localStorage.removeItem(e)}},reText={tabs:" <br><br>You can nest TabbedPanels by inserting them inside a Tab item. <br><br>Visible tabs are selected on export (WYSIWYG)."},item={list:{}};item.list.dialog=function(e){return{type:"Dialog",parent:!0,defaultStyle:{varName:null,text:"Dialog",preferredSize:[0,0],margins:16,orientation:"column",spacing:10,alignChildren:["center","top"]},previewHtml:'<div id="dialog-container" data-parent="true" data-parent="true" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div id="dialog-title-bar"><div contenteditable="true">'+e.type+'</div></div><div class="padding-box"></div></div>'}},item.list.group=function(e){return{type:"Group",parent:!0,addPanelIconClass:"fas fa-object-group",defaultStyle:{varName:null,preferredSize:[0,0],margins:0,orientation:"row",spacing:10,alignChildren:["left","center"],alignment:null},previewHtml:'<div class="group" data-parent="true" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div class="padding-box"></div></div>'}},item.list.panel=function(e){return{type:"Panel",parent:!0,addPanelDivider:"below",addPanelIconClass:"fas fa-columns",defaultStyle:{varName:null,text:"Panel",preferredSize:[0,0],margins:10,orientation:"column",spacing:10,alignChildren:["left","top"],alignment:null},previewHtml:'<div class="panel" data-parent="true" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><span class="title" contenteditable="true">'+e.type+'</span><div class="padding-box"></div></div>'}},item.list.statictext=function(e){return{type:"StaticText",addPanelIconClass:"fas fa-font",multiline:!0,editInfo:'This item supports multiline text. <br><br>Due to issues with ScriptUI multiline text, the code export will not output "true" multiline. <br><br>Instead, multiline <code>statictext</code> will be sliced and diced into several <code>statictext</code> and put inside a <code>group</code>.',defaultStyle:{varName:null,text:"StaticText",justify:"left",preferredSize:[0,0],alignment:null},previewHtml:'<div class="static-text" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><span class="text-container" contenteditable="true">'+e.type+"</span></div>"}},item.list.edittext=function(e){return{type:"EditText",addPanelIconClass:"fas fa-i-cursor",multiline:!0,editInfo:"This item supports multiline text. <br><br>Multiline text flow may differ drastically from ScriptUI.",defaultStyle:{varName:null,text:"EditText",preferredSize:[0,0],alignment:null},previewHtml:'<div class="edit-text" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><span class="edit-text-inner-wrap"><span class="text-container" contenteditable="true">'+e.type+"</span></span></div>"}},item.list.button=function(e){return{type:"Button",addPanelIconClass:"fas fa-toggle-on",defaultStyle:{varName:null,text:"Button",justify:"center",preferredSize:[0,0],alignment:null},previewHtml:'<div class="button" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div class="button-border"><span class="text-container" contenteditable="true">'+e.type+"</span></div></div>"}},item.list.divider=function(e){return{type:"Divider",addPanelIconClass:"fas fa-strikethrough",defaultStyle:{varName:null},stylePropInfo:"This item doesn't have any adjustable properties.",editInfo:"Divider orientation is locked to the parent item orientation.",previewHtml:'<div class="panel divider-line" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div class="padding-box"></div></div>'}},item.list.checkbox=function(e){return{type:"Checkbox",addPanelIconClass:"fas fa-check-square",editInfo:"You can check the checkbox in the dialog preview.",defaultStyle:{varName:null,text:"Checkbox",preferredSize:[0,0],alignment:null},previewHtml:'<div class="checkbox" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div class="radiocheck checkbox"><i class="fas fa-check"></i></i></div><label contenteditable="true">'+e.type+"</label></div>"}},item.list.radiobutton=function(e){return{type:"RadioButton",addPanelIconClass:"fas fa-dot-circle",editInfo:"You can check the radiobutton in the dialog preview. <br><br> Radiobuttons are split into different groups if there is a different type of item between them.",defaultStyle:{varName:null,text:"RadioButton",preferredSize:[0,0],alignment:null},previewHtml:'<div class="radiobutton" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div class="radiocheck radiobutton"><i class="fas fa-circle"></i></div><label contenteditable="true">'+e.type+"</label></div>"}},item.list.dropdownlist=function(e){return{type:"DropDownList",addPanelIconClass:"fas fa-caret-square-down",editInfo:"You can select a dropdown item in the dialog preview. <br><br>You can make a divider by adding an item that is a single dash character: <code>-</code>.",defaultStyle:{varName:null,text:"DropDownList",listItems:"Item 1, -, Item 2",preferredSize:[0,0],alignment:null,selection:0},previewHtml:'<div class="dropdownlist" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><label contenteditable="true">'+e.type+'</label><div class="drop-list-wrap"><div class="items"><div class="selected">Item 1</div><div>-</div><div>Item 2</div></div><div class="arrow"><i class="fas fa-chevron-down"></i></div></div></div>'}},item.list.slider=function(e){return{type:"Slider",addPanelIconClass:"fas fa-sliders-h",defaultStyle:{varName:null},stylePropInfo:"This item doesn't have any adjustable properties.",editInfo:"Export outputs a static range from 0 to 100 with current value of 50 every single time.",previewHtml:'<div class="slider" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><input type="range" min="0" max="100" value="" /></div>'}},item.list.listbox=function(e){return{type:"ListBox",addPanelIconClass:"fas fa-list-alt",editInfo:"You can select item(s) in the dialog preview. <br><br> If you select multiple items, <code>multiline</code> property will be added on export.",defaultStyle:{varName:null,listItems:"Item 1, Item 2",preferredSize:[0,0],alignment:null},previewHtml:'<div class="list-box" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div class="inner-wrap"><ul><li><span>Item 1</span></li><li><span>Item 2</span></li></ul></div></div>'}},item.list.image=function(e){return{type:"Image",addPanelIconClass:"fas fa-image",editInfo:"Allowed formats: <code>jpg, png</code><br><br> Images are never uploaded to any server, they are stored locally in your browser.<br><br> Resize images before adding them to the dialog.<br><br> I would recommend small icon sizes. Any images will bump up the script file size quite a bit so you should likely use minimal amount of images.",defaultStyle:{varName:null,image:["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQdJREFUeNrslv0NgyAQxcV0AEZwBEdoN3AEu0E7iSN0hW6gG9gRuoFuQB8NtGg9QSL4R33JixcUf3zcEZiAkg2UJhvpYMRX+BGYl8PVOxJfHV164rsc5j5UydCwdEGnAu4QtnCH+OY7AOcZ410moeJXVegZFzAn2jfJah4afF/Yvg6YMfbE4wz3RnOjSjBcchnfcpUgWbRyUjPv4UatgDmYWtZ3tORSdVzDcrUWwVPLjyu4tEBzI8Pd4dQeq5NJq5zY61ZMq6Pg5h5PgkfQAdwCnYXPggmo1sUBSsJJsAXqowGcArcijD5wE8wiXX3kiXfSmR/z6jMuvYT93WVvB+/gHbyaXgIMAHWCmD3KjfSwAAAAAElFTkSuQmCC"],alignment:null},previewHtml:'<div class="image-item" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><img src="" alt="" /></div>'}},item.list.tabbedpanel=function(e){return{type:"TabbedPanel",parent:!0,addPanelDivider:"above",addPanelIconClass:"fas fa-folder",editInfo:'<strong>Valid child item:</strong> <br><i class="far fa-folder"></i> Tab.'+reText.tabs,defaultStyle:{varName:null,preferredSize:[0,0],margins:10,alignment:null},previewHtml:'<div class="panel tabbed-panel" data-parent="true" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div class="tab-container"></div><div class="padding-box"></div></div>'}},item.list.tab=function(e){return{type:"Tab",parent:!0,addPanelDivider:"below",addPanelIconClass:"far fa-folder",editInfo:"Can only be placed inside <br><i class='fas fa-folder'></i> TabbedPanel."+reText.tabs,defaultStyle:{varName:null,text:"Tab",orientation:"column",spacing:10,alignChildren:["left","top"]},previewHtml:'<div class="panel tab" data-parent="true" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div class="padding-box"></div></div>'}},item.list.treeview=function(e){return{type:"TreeView",parent:!0,addPanelIconClass:"fas fa-tree",editInfo:'<strong>Valid child item:</strong> <br> <i class="fas fa-leaf"></i> TreeItem.',defaultStyle:{varName:null,preferredSize:[0,0],alignment:null},previewHtml:'<div class="panel tree-view" data-parent="true" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div class="padding-box"></div></div>'}},item.list.treeitem=function(e){return{type:"TreeItem",parent:!0,addPanelDivider:"below",addPanelIconClass:"fas fa-leaf",editInfo:'<strong>Valid child item:</strong> <br> <i class="fas fa-leaf"></i> TreeItem. <br><br>You can expand or collapse these items in the dialog preview by clicking the arrows.',defaultStyle:{varName:null,text:"TreeItem"},previewHtml:'<div class="tree-view-item" data-parent="true" data-item-type="'+e.type+'" data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'"><div class="item-wrap"><span class="tree-view-arrow"><i class="fas fa-chevron-right"></i></span><span class="text-container" contenteditable="true">'+e.type+'</span></div><div class="padding-box"></div></div>'}},item.funnel={create:function(e){e.style=item.create.localStorage(e),item.create.treeView(e),item.update.order(),item.create.dialogPreview(e),item.activate(e.id),tab.onCreate(e);item.funnel.update("all","localStorage"),"loadFromLocalStorage"===e.event||edit_style_panel.build(e.style),"TabbedPanel"===e.type&&tabbedPanel.onCreate(e.event),"TreeView"===e.type&&treeView.onCreate(e.event);var t=$('#dialog [data-item-id="'+e.id+'"]');if("EditText"===e.type){var a=t.find(".edit-text-inner-wrap"),i=t.find("[contenteditable]"),n=a.overlayScrollbars({paddingAbsolute:!0}).overlayScrollbars(),s=$(n.getElements().host).find(".os-content-glue").first(),l=function(){s.html(i.html())};l(),i.on("input",function(){l()})}else"ListBox"===e.type&&t.find(".inner-wrap").overlayScrollbars({});$("#dialog-section").backstretch("resize")},remove:function(e){var t=$('#panel-tree-view-wrap [data-item-id="'+e+'"]'),a=t.prev(),i=t.next(),n=t.parent("ul").parent("li"),s=t.data("item-type");if(item.remove.treeView(e),item.remove.dialogPreview(e,s),item.remove.localStorage(),$("#panel-tree-view-wrap .active").length<1){e=i.length>0&&i.data("item-id")||a.length>0&&a.data("item-id")||n.data("item-id"),item.activate(e);var l=local_storage.get("dialog");edit_style_panel.build(l.items["item-"+e].style)}setTimeout(function(){$("#dialog-section").backstretch("resize")},1)},update:function(e,t){droplist.hide();var a=local_storage.get("dialog"),i=(a="localStorage"===t?a:item.update.style.localStorage(e,a)).items["item-"+a.activeId];item.update.style.treeView(e,a,i),"dialog"!==t&&item.update.style.dialogPreview(e,a,i),treeViewItem.onUpdate(a,i),forceSize.onUpdate(e,a,i),setTimeout(function(){$("#dialog-section").backstretch("resize")},10)},sort:function(e,t,a,i,n){item.sort.dialogPreview(e,t,a,i,n),item.sort.localStorage(e,t),$("#dialog-section").backstretch("resize")}},item.create={localStorage:function(e){var t=local_storage.get("dialog"),a=(t=null===t?{}:t).hasOwnProperty("items"),i="item-"+e.id,n=!1;if(a&&(n=t.items.hasOwnProperty(i)),t.activeId=e.id,!n){void 0===t.items&&(t.items={}),void 0===t.items[i]&&(t.items[i]={});var s=t.items[i];s.id=e.id,s.type=e.type,s.parentId=e.parentId,e.sourceId?s.style=$.extend(!0,{},t.items["item-"+e.sourceId].style):s.style=item.list[e.type.toLowerCase()](e).defaultStyle}return t.items["item-"+e.id],void 0===t.items["item-"+e.id].style.varName&&(t.items["item-"+e.id].style.varName=null),local_storage.set("dialog",t),t.items["item-"+e.id].style},treeView:function(e){var t=item.list[e.type.toLowerCase()](!1).parent?'data-parent="true"':"",a=$("<li "+t+' data-item-id="'+e.id+'" data-item-parent-id="'+e.parentId+'" data-item-type="'+e.type+'" class="'+e.type.toLowerCase()+'"><span class="remove-item"><i class="fas fa-times"></i></span><span class="item-text">'+e.type+"</span></li>");"Dialog"===e.type&&(a=$('<ul class="tree-dialog">'+a.prop("outerHTML")+"</ul>")).find("> li").addClass("tree-root");var i=e.type.toLowerCase();item.list[i](!1).parent&&$("<ul></ul>").insertAfter(a.find(".item-text")),t=(e.target.is("ul")?e.target.parent("li"):e.target).data("parent");var n,s=e.event.match(/^drag/);n=t?s?e.previousIsParent?"insertAfter":"prependTo":"appendTo":"insertAfter",$(a)[n](e.target)},dialogPreview:function(e){var t,a,i=item.list[e.type.toLowerCase()](e).previewHtml,n=e.target.is("ul")?e.target.parent("li"):e.target,s=n.data("parent"),l=n.data("item-id"),r=$("#dialog"),d=r.find('[data-item-id="'+l+'"]'),o=e.event.match(/^drag/);s?(t=o?e.previousIsParent?"insertAfter":"prependTo":"appendTo",a="Dialog"===e.type?r:o&&e.previousIsParent?d:d.find("> .padding-box")):(t="insertAfter",a=r.find('[data-item-id="'+l+'"]')),$(i)[t](a);var c=$('#dialog [data-item-id="'+e.id+'"]');"DropDownList"===e.type?droplist.init(c,e.id):"RadioButton"===e.type||"Checkbox"===e.type?radiocheck.init(c,e.id,e.type):"ListBox"===e.type&&listbox.init(c,e.id)}},item.get={},item.get.order=function(){var e=[];return $("#panel-tree-view-wrap .contents [data-item-id]").each(function(){var t=$(this).data("item-id");e.push(t)}),e},item.get.id=function(){var e=item.get.order();return Math.max.apply(null,e)+1},item.activate=function(e){droplist.hide();var t=local_storage.get("dialog");t.activeId=e,local_storage.set("dialog",t);var a=$("#panel-tree-view-wrap");a.find(".active").removeClass("active");var i=a.find('[data-item-id="'+e+'"]');i.addClass("active");var n=$("#dialog");n.find(".active").removeClass("active"),n.find('[data-item-id="'+e+'"]').addClass("active"),tab.onActivate(e),breadCrumbs(a,i),lightThePath(a,i)},item.remove={localStorage:function(){var e=local_storage.get("dialog");e.order=function(){var e=[];return $("#tree-view-contents [data-item-id]").each(function(){e.push($(this).data("item-id"))}),e}(),$.each(function(e){var t=[];return $.each(e.items,function(e,a){t.push(a.id)}),t}(e),function(t,a){$.inArray(a,e.order)<0&&delete e.items["item-"+a]}),local_storage.set("dialog",e)},treeView:function(e){$("#panel-tree-view-wrap").find('[data-item-id="'+e+'"]').remove()},dialogPreview:function(e,t){tab.onRemove(e,t);var a=$("#dialog");a.find('[data-item-id="'+e+'"]').length>0&&a.find('[data-item-id="'+e+'"]').remove()}},item.sort={localStorage:function(e,t){var a,i=local_storage.get("dialog");i.order=(a=[],$("#tree-view-contents [data-item-id]").each(function(){var e=$(this).data("item-id");a.push(e)}),a),i.items["item-"+e].parentId=t,local_storage.set("dialog",i)},dialogPreview:function(e,t,a,i,n){var s=$("#dialog"),l=s.find('[data-item-id="'+e+'"]'),r=s.find('[data-item-id="'+n+'"]'),d="insertAfter"===i?r:r.find("> .padding-box");if(l[i](d),"RadioButton"===a){var o=l.find(".radiobutton"),c=o.hasClass("on"),p=0,m=':not([data-item-type="RadioButton"],.spacing)';if(l.nextUntil(m).add(l.prevUntil(m)).each(function(){$(this).find(".radiobutton").hasClass("on")&&++p}),p>0&&c){o.removeClass("on");var g=local_storage.get("dialog");g.items["item-"+e].style.checked=!1,local_storage.set("dialog",g)}}}},item.update={},item.update.style={},item.update.style.localStorage=function(e,t){var a=item.update.get_values(e);return t.items["item-"+t.activeId].style[e]=a[e],local_storage.set("dialog",t),t},item.update.style.treeView=function(e,t,a){if("text"===e||"all"===e){var i=a.style.text,n=$('#panel-tree-view-wrap [data-item-id="'+a.id+'"] > .item-text'),s=a.type,l=void 0===i?s:i.trim();n.html(s.toLowerCase()===l.toLowerCase()?s:'<span class="type">'+s+':</span> <span class="txt">'+i+"</span>")}},item.update.style.dialogPreview=function(e,t,a,i){var n={property:e,value:a.style[e],data:t,dataItem:a,event:i};"all"===e?$.each(a.style,function(e,t){n.property=e,n.value=t,item.update.set_values(n)}):item.update.set_values(n)},item.update.order=function(){var e=local_storage.get("dialog");e.order=item.get.order(),local_storage.set("dialog",e)},item.update.get_values=function(e){var t={},a=$("#panel-edit-style-wrap"),i=a.find('[data-edit^="'+e+'"]');switch(e){case"varName":t.varName=i.val();break;case"text":t.text=i.val();break;case"listItems":t.listItems=i.val();break;case"justify":t.justify=a.find('[data-edit^="justify"].active').data("value");break;case"margins":if(a.find(".n-3-4.hidden").length>0)t.margins=parseInt(a.find(".margin-inputs .top").val(),10);else{var n=[];a.find('[data-edit="margins"]').each(function(){n.push(parseInt($(this).val(),10))}),t.margins=n}break;case"preferredSize":var s=parseInt(a.find("input.width").val(),10),l=parseInt(a.find("input.height").val(),10);t.preferredSize=[s,l];break;case"orientation":t.orientation=i.find("option:selected").val();break;case"spacing":t.spacing=parseInt(i.val(),10);break;case"alignChildren":var r=a.find('#align-children-horizontal[data-edit="alignChildren"] option:selected').val(),d=a.find('#align-children-vertical[data-edit="alignChildren"] option:selected').val();t.alignChildren=[r,d];break;case"image":t.image=[a.find(".base64-bin").attr("src")];break;case"alignment":
!1===i.prop("disabled")?t.alignment=i.find("option:selected").val():t.alignment=null;break}return t},item.update.set_values=function(e){var t=e.value,a=e.dataItem.type,i=e.dataItem.style,n=e.dataItem.id,s=$("#dialog .active"),l=s.find("> .padding-box");switch(e.property){case"text":if("Dialog"===a)s.find("#dialog-title-bar div").text(t);else if("Panel"===a){var r=s.find("> .title");r.text(t),l.css({minWidth:r.width()+22})}else if(s.find("> label").length>0)s.find("label").text(t);else if("Tab"===a)s.parent().parent().find('> .tab-container [data-tab-id="'+n+'"]').text(t);else if("TreeItem"===a)s.find("> .item-wrap .text-container").text(t);else if(item.list[a.toLowerCase()](!1).multiline){s.find(".text-container").html(t.split("\n").join("<br>"))}else s.find(".text-container").html(t);break;case"listItems":"DropDownList"===a?droplist.set.items(s,t,i):"ListBox"===a&&listbox.set(s,t,i);break;case"checked":!0===t&&s.find("input").prop("checked",!0);break;case"justify":s.removeClass(function(e,t){return(t.match(/(^|\s)justify-\S+/g)||[]).join(" ")}).addClass("justify-"+e.value);break;case"margins":var d=t[0],o=t[1],c=t[2],p=t[3],m="object"!=typeof t,g=m?t:d,u=m?t:o,f=m?t:c,v=m?t:p;"Dialog"===a?l.css({paddingTop:g<=6?1:g,paddingRight:u<=1?1:u,paddingBottom:f<=1?1:f,paddingLeft:v<=1?1:v}):"Panel"===a?l.css({paddingTop:g<=3?3:g,paddingRight:u<=3?3:u,paddingBottom:f<=1?1:f,paddingLeft:v<=3?3:v}):"TabbedPanel"===a?tabbedPanel.set.margins(g,u,f,v,n,l):l.css({paddingTop:g,paddingRight:u,paddingBottom:f,paddingLeft:v});break;case"preferredSize":var h=0==t[0]?"auto":t[0],b=0==t[1]?"auto":t[1]+("Dialog"===a?$("#dialog-title-bar").outerHeight():0);s.css({minWidth:h,minHeight:b}),dangerZone.set(e,s,l),droplist.set.size(s,t,i,a,h,b);break;case"orientation":s.removeClass(function(e,t){return(t.match(/(^|\s)orientation-\S+/g)||[]).join(" ")}).addClass("orientation-"+t);break;case"spacing":var y=s.find("> .padding-box");y.find("> style.spacing").remove();var w=0,C=e.data.items["item-"+n].parentId;if(!1!==C)"row"===e.data.items["item-"+C].style.orientation&&(w=2);t+=w,$('<style class="spacing">#dialog [data-item-id="'+s.data("item-id")+'"].orientation-row > .padding-box > div {padding-left: '+t+'px;}\n#dialog [data-item-id="'+s.data("item-id")+'"].orientation-row > .padding-box > div:first-of-type {padding-left: 0px;}\n#dialog [data-item-id="'+s.data("item-id")+'"].orientation-column > .padding-box > div {padding-top: '+t+'px;}\n#dialog [data-item-id="'+s.data("item-id")+'"].orientation-column > .padding-box > div:first-of-type {padding-top: 0px;}</style>').appendTo(y);break;case"alignChildren":s.removeClass(function(e,t){return(t.match(/(^|\s)align-children-\S+/g)||[]).join(" ")}),s.addClass("align-children-horizontal-"+t[0]),s.addClass("align-children-vertical-"+t[1]);break;case"image":s.find("img").attr("src",t[0]);break;case"alignment":if(s.removeClass(function(e,t){return(t.match(/(^|\s)alignment-\S+/g)||[]).join(" ")}),null!==t){var x="left"===t&&["left","top"]||"top"===t&&["left","top"]||"right"===t&&["right","bottom"]||"bottom"===t&&["right","bottom"]||[t,t];s.addClass("alignment-horizontal-"+x[0]),s.addClass("alignment-vertical-"+x[1])}break}};var tabbedPanel={onCreate:function(e){if("loadFromLocalStorage"!==e&&"drag-duplicate"!==e){var t=$("#panel-tree-view-wrap"),a=t.find(".active"),i=a.data("item-id"),n={id:item.get.id(),type:"Tab",parentId:a.data("item-id"),target:a.find("> ul"),event:"parent-propagation"};item.funnel.create(n);var s=t.find(".active").data("item-id");item.activate(i),n.id=item.get.id(),item.funnel.create(n),item.activate(s)}var l=$("#panel-new-item-wrap .tab");l.hasClass("show")||l.addClass("show")},onDragValid:function(e,t){var a=t.target.parent("li"),i=e.hasClass("tab"),n=a.hasClass("tabbedpanel");return i&&!n||!i&&n},onClick:function(e,t){var a=t.data("item-type"),i=e.hasClass("tab"),n="TabbedPanel"===a,s=i&&!n||!i&&n;if(s){var l=$("#panel-edit-style-wrap .edit-info");l.removeClass("highlight-animation"),setTimeout(function(){l.addClass("highlight-animation")},10)}return s},set:{margins:function(e,t,a,i,n,s){s.find("> .margins").remove(),$('<style class="margins">#dialog [data-item-id="'+n+'"] > .padding-box > .tab > .padding-box {padding: '+(e<=3?3:e)+"px "+(t<=3?3:t)+"px "+(a<=1?1:a)+"px "+(i<=3?3:i)+"px;}\n</style>").prependTo(s)}}},tab={onCreate:function(e){if("Tab"===e.type){var t=$('#dialog [data-item-id="'+e.parentId+'"]'),a=t.find("> .tab-container");$('<div class="tab" data-tab-id="'+e.id+'" contenteditable>'+e.style.text+"</div>").appendTo(a),tab.containerSort(t.find("> .padding-box > .tab"),a),item.activate(e.id);var i=local_storage.get("dialog");edit_style_panel.build(i.items["item-"+e.id].style)}},onActivate:function(e){var t=$('#panel-tree-view-wrap [data-item-id="'+e+'"]'),a=$('#dialog .tab-container [data-tab-id="'+e+'"]');if($("#dialog .currently-active-tab").removeClass("currently-active-tab"),a.addClass("currently-active-tab"),t.closest(".tabbedpanel").length>0){var i=local_storage.get("dialog");t.parentsUntil(".dialog").filter(".tab").add("Tab"===t.data("item-type")&&t).each(function(){var e=i.items["item-"+$(this).data("item-id")],t=i.items["item-"+$(this).data("item-parent-id")];tab.show(e,t),$(this).css({minWidth:"",minHeight:""}),t.style.selection=e.id,local_storage.set("dialog",i)})}"Tab"===t.data("item-type")&&tab.resizeActive(e)},resizeActive:function(e){var t=$('#dialog [data-item-id="'+e+'"]'),a="visible-tab";t.addClass("tab-width-auto");var i=t.width(),n=t.height();t.removeClass("tab-width-auto");var s=0,l=0;t.removeClass(a),t.siblings(".tab").each(function(){$(this).addClass(a+" tab-width-auto"),$(this).width()>s&&(s=$(this).width()),$(this).height()>l&&(l=$(this).height()),$(this).removeClass(a+" tab-width-auto"),$(this).css({minWidth:"",minHeight:""})}),s>i?t.css({minWidth:s}):t.css({minWidth:""}),l>n?t.css({minHeight:l}):t.css({minHeight:""}),t.addClass(a)},show:function(e,t){$('#dialog [data-item-id="'+t.id+'"] > .tab-container [data-tab-id="'+e.id+'"]').addClass("visible").siblings().removeClass("visible"),$('#dialog [data-item-id="'+t.id+'"] > .padding-box > [data-item-id="'+e.id+'"]').addClass("visible-tab").siblings().removeClass("visible-tab")},onRemove:function(e,t){var a,i=local_storage.get("dialog"),n=$('#dialog [data-item-id="'+e+'"]');if("Tab"===t){a=e,$('#dialog div[data-tab-id="'+a+'"]').remove();var s=i.items["item-"+e];a=$('#panel-tree-view-wrap [data-item-id="'+s.parentId+'"] > ul > li:first').data("item-id");var l=n.siblings(".visible-tab"),r=n.prev().length>0&&n.prev().data("item-id")||n.next().length>0&&n.next().data("item-id")||n.closest(".panel.tab").length>0&&n.closest(".panel.tab").data("item-id")||!1;n.remove(),l.length>0&&tab.resizeActive(l.data("item-id")),l.length<1&&r&&item.activate(r)}else n.closest(".tab").length>0&&n.remove()},onStartSort:function(e){if(e.hasClass("tab")){$("body").addClass("dragging-tab");var t=e.prev().length>0&&e.prev().data("item-id")||e.next().length>0&&e.next().data("item-id")||e.closest(".tab").length>0&&e.closest(".tab").data("item-id")||!1;t&&$('#dialog [data-item-id="'+t+'"]').addClass("dragged-tab-relative")}},onSort:function(e){var t=e.hasClass("tab"),a=e.hasClass("tabbedpanel");if(t||a||$('#dialog [data-item-id="'+e.data("item-id")+'"]').closest(".tab").length>0){$("body").removeClass("dragging-tab");var i=local_storage.get("dialog"),n=e.data("item-id"),s=i.items["item-"+n].parentId,l=$("#dialog"),r=l.find('[data-item-id="'+s+'"]'),d=r.find("> .tab-container");l.find('.tab-container [data-tab-id="'+n+'"]').appendTo(d);var o=r.find("> .padding-box > .tab");tab.containerSort(o,d);var c=$("#dialog .dragged-tab-relative").removeClass("dragged-tab-relative");item.activate(c.data("item-id")),item.activate(n),edit_style_panel.build(i.items["item-"+n].style)}},containerSort:function(e,t){e.each(function(){var e=$(this).data("item-id");t.find('[data-tab-id="'+e+'"]').appendTo(t)})}},treeView={onCreate:function(e){if("loadFromLocalStorage"!==e&&"drag-duplicate"!==e){var t=$("#panel-tree-view-wrap"),a=t.find(".active"),i=a.data("item-id"),n={id:item.get.id(),type:"TreeItem",parentId:a.data("item-id"),target:a.find("> ul"),event:"parent-propagation"};item.funnel.create(n);var s=t.find(".active").data("item-id");item.activate(i),n.id=item.get.id(),item.funnel.create(n),item.activate(s)}var l=$("#panel-new-item-wrap .treeitem");l.hasClass("show")||l.addClass("show")},onDragValid:function(e,t){var a=t.target.parent("li"),i=e.hasClass("treeitem"),n=a.hasClass("treeview"),s=a.hasClass("treeitem");return i&&!n&&!s||!i&&(n||s)},onClick:function(e,t){var a=t.data("item-type"),i=e.hasClass("treeitem"),n="TreeView"===a,s="TreeItem"===a,l=i&&!n&&!s||!i&&(n||s);if(l){var r=$("#panel-edit-style-wrap .edit-info");r.removeClass("highlight-animation"),setTimeout(function(){r.addClass("highlight-animation")},10)}return l}},treeViewItem={onClick:function(){$("#dialog").on("click",".tree-view-arrow",function(){var e=$(this).parent(".item-wrap").parent(".tree-view-item"),t=e.data("item-id"),a=local_storage.get("dialog"),i=a.items["item-"+t];treeViewItem.expand(a,i,e,!0)})},onSort:function(e,t,a){if("TreeItem"===t){$('#dialog [data-item-id="'+a+'"]').parent(".padding-box").parent(".tree-view-item").addClass("tree-node");var i=$("#dialog .tree-node > .padding-box:empty").parent().removeClass("tree-node expanded");if(i.length>0){var n=i.data("item-id"),s=local_storage.get("dialog");delete s.items["item-"+n].expanded,local_storage.set("dialog",s)}}},onUpdate:function(e,t){if("TreeItem"===t.type){var a=$('#dialog [data-item-id="'+t.id+'"]');a.parent(".padding-box").parent(".tree-view-item").length>0&&a.parent(".padding-box").parent(".tree-view-item").addClass("tree-node"),treeViewItem.expand(e,t,a)}},expand:function(e,t,a,i){var n;if(!0!==i)n=t.expanded?"addClass":"removeClass";else{var s=a.hasClass("expanded");n=s?"removeClass":"addClass"}a[n]("expanded"),i&&(s?delete e.items["item-"+t.id].expanded:e.items["item-"+t.id].expanded=!0,local_storage.set("dialog",e))}};treeViewItem.onClick();var listbox={init:function(e,t){e.on("click","li",function(){var a=$(this);listbox.clickety(t,e,a)})},clickety:function(e,t,a){var i=a.hasClass("selected")?"removeClass":"addClass";a[i]("selected");var n=[];t.find("li").each(function(){$(this).hasClass("selected")&&n.push($(this).index())});var s=local_storage.get("dialog");s.items["item-"+e].style.selection=n,local_storage.set("dialog",s)},set:function(e,t){var a=e.find("ul");a.children().remove();var i,n,s=t.split(","),l=local_storage.get("dialog"),r=l.items["item-"+l.activeId];void 0!==r.style.selection&&(i=r.style.selection,n=0,$.each(i,function(e,t){n<t&&(n=t)}),n>=s.length&&r.style.selection.pop(),local_storage.set("dialog",l)),$.each(s,function(e,t){var i=t.trim(),n=$.inArray(e,r.style.selection)>=0;$("<li"+(n?' class="selected"':"")+"><span>"+i+"</span></li>").appendTo(a)})}};droplistOnWindowResize();var droplist={init:function(e,t){e.find(".drop-list-wrap").on("click",function(){$("#drop-list").remove();var e=$(this);if(e.hasClass("open"))droplist.hide();else{e.addClass("open");var a=droplist.inspector(t,e);droplist.makeList(t,e,a),$("#drop-list ul li").on("click",function(){var a=$(this),i=local_storage.get("dialog");i.items["item-"+t].style.selection=a.index(),local_storage.set("dialog",i),e.find(".selected").removeClass("selected"),e.find(".items").children().eq(a.index()).addClass("selected"),droplist.hide()})}})},backbone:function(e){var t=null,a=e.find(".items").children();a.each(function(){var e=$(this).width();e>t&&(t=e)}),a.width(t)},inspector:function(e,t){var a="",i=t.find(".selected").index();return t.find(".items").children().each(function(e){var t=$(this).text();a+='<li class="option'+("-"===t?" horizontal-line":"")+(e===i?" selected":"")+'">'+t+"</li>"}),a},makeList:function(e,t,a){var i=t.offset().top,n=t.offset().left,s=t.outerWidth(),l=t.outerHeight();$('<div id="drop-list"><ul>'+a+"</ul></div>").appendTo("#dialog-section");var r=$("#drop-list"),d=2*parseInt(r.css("border-left-width"),10),o=2*parseInt(r.css("padding-left"),10);r.css({top:i+l,left:n-($(window).width()-$("#dialog-overlay-wrap").width()),width:s-(d+o)})},set:{items:function(e,t,a){var i=e.find(".items");i.children().remove();var n=!1;if($.each(t.split(","),function(e,t){var s=t.trim(),l="-"==s?" horizontal-line":"",r=e===a.selection?" selected test":"";e===a.selection&&(n=!0),$('<div class="'+r+l+'">'+s+"</div>").appendTo(i)}),!n){var s=local_storage.get("dialog");s.items["item-"+s.activeId].style.selection=0,local_storage.set("dialog",s),i.find("> div:first").addClass("selected")}var l=e.find(".drop-list-wrap");droplist.backbone(l)},size:function(e,t,a,i,n){if("DropDownList"===i){var s=e.find(".drop-list-wrap"),l=e.find("label");e.removeClass("too-big"),e.removeClass("too-small"),e.addClass("get-width");var r=e.width(),d=l.outerWidth(!0),o=s.outerWidth(!0);e.removeClass("get-width");var c=d+o;n>c?(e.addClass("too-big"),o<r&&s.width("auto")):n<c&&(e.addClass("too-small"),o>r&&s.width(r-16),e.parent().parent().hasClass("orientation-row")&&e.find("label").css({marginLeft:e.css("padding-left")}))}}},hide:function(){$("#drop-list").remove(),$(".drop-list-wrap.open").removeClass("open")}},radiocheck={init:function(e,t,a){var i=this,n=e.find(".radiocheck");i.restore(e,t,a,n),n.on("click",function(){var e=$(this),a=local_storage.get("dialog"),n=a.items["item-"+t],s=e.hasClass("on");e[s?"removeClass":"addClass"]("on");var l=!s;e.is(".radiobutton")?(i.radio.clearSiblings(a,e),n.style.checked=l):n.style.checked=l,local_storage.set("dialog",a)})},restore:function(e,t,a,i){!0===local_storage.get("dialog").items["item-"+t].style.checked&&i.addClass("on")},radio:{clearSiblings:function(e,t){var a=t.parent(),i=':not([data-item-type="RadioButton"],.spacing)';a.nextUntil(i).add(a.prevUntil(i)).each(function(){var t=$(this),a=t.data("item-id"),i=t.find(".radiocheck");t.hasClass("radiobutton")&&(i.removeClass("on"),e.items["item-"+a].style.checked=!1)})}}},addItemsPanel={init:function(){this.generateHTML(),$("#panel-new-item-wrap li").on("click",function(){var e=$("#panel-tree-view-wrap").find(".active"),t=e.data("parent"),a={id:item.get.id(),type:$(this).data("item-type"),parentId:t?e.data("item-id"):e.data("item-parent-id"),target:t?e.find("> ul"):e,event:"click"},i=tabbedPanel.onClick($(this),e,a),n=treeView.onClick($(this),e,a);i||n||item.funnel.create(a)})},generateHTML:function(){var e="";$.each(item.list,function(t){var a=item.list[t](!1);a.addPanelIconClass&&("above"===a.addPanelDivider&&(e+='<span class="gouping-divider"></span>'),e+='<li class="'+t+'" data-item-type="'+a.type+'"><i class="fas fa-info-circle failure-is-an-option"></i><i class="'+a.addPanelIconClass+'"></i><span>'+a.type+"</span></li>","below"===a.addPanelDivider&&(e+='<span class="gouping-divider"></span>'))}),e+='<div class="disabled-overlay"></div>',$("<ul>"+e+"<ul>").appendTo("#panel-new-item-wrap .contents")}};addItemsPanel.init();var edit_style_panel={build:function(e,t){var a=$("#edit-style-inner-container");a.html('<span class="target-varName"></span><span class="target-image"></span><span class="target-text"></span><span class="target-listItems"></span><span class="target-justify"></span><span class="target-preferredSize"></span><span class="target-margins"></span><span class="target-orientation"></span><span class="target-spacing"></span><span class="target-alignChildren"></span><span class="target-alignment"></span>');var i=$("#panel-tree-view-wrap .active").data("item-type").toLowerCase(),n=item.list[i](!1);if(!1===e)$("<div class='no-properties'>"+n.stylePropInfo+"</div>").appendTo(a);else{$.each(e,function(e,t){var i=panel_edit_style_html.init(e,t);void 0!==i&&i.appendTo(a.find(".target-"+e))}),numberInputs();var s=item.list[i](!1).defaultStyle.text,l=item.list[i](!1).multiline,r=$('#panel-edit-style-wrap [data-edit="text"]'),d=r.parent();!s||l||d.hasClass("is-not-multiline")||d.addClass("is-not-multiline"),$(".pretty-classic").prettyDropdown({classic:!0,customClass:"arrow triangle",selectedMarker:'<i class="fas fa-check"></i>'}),$("#panel-edit-style-wrap textarea").each(function(){autosize(this)}),"dialog"!==t&&s&&(r.focus(),r.select())}var o=n.editInfo;o&&$('<div class="edit-info">'+o+"</div>").appendTo(a)}},panel_edit_style_html={init:function(e,t){var a;switch(e){case"varName":a=$('<h2>Custom Variable Name</h2><input type="text" data-edit="varName" value="'+(null==t?"":t)+'" />');break;case"text":a=$('<h2 title="Initial text to be displayed in the control as the title, label, or contents, depending on the control type.">Text</h2><div class="edit-text-wrap"><div class="no-linebreaks-icon" title="This item does not support multiline, so no line breaks."><img src="assets/images/no-line-break-icon.svg" alt="" /></div><textarea data-edit="text" class="textarea">'+t+"</textarea><div>");break;case"listItems":a=$('<h2 title="The array of choice items displayed in the drop-down or pop-up list.">List Items<span class="desc"> (Comma separated)</span></h2><textarea data-edit="listItems" class="textarea">'+t+"</textarea>");break;case"justify":(a=$('<div class="justify-container"><h4>Justify:</h4><div class="justify-icon-wrap"><div class="justify-icon" data-edit="justify" data-value="left"><i class="icon fas fa-align-left"></i></div><div class="justify-icon" data-edit="justify" data-value="center"><i class="icon fas fa-align-center"></i></div><div class="justify-icon" data-edit="justify" data-value="right"><i class="icon fas fa-align-right"></i></div></div></div>')).find('[data-value="'+t+'"]').addClass("active");break;case"margins":var i="object"!=typeof t;a=$('<h2 title="The number of pixels between the edges of a container and the outermost child elements. \n\nYou can specify different margins for each edge of the container. The default value is based on the type of container, and is chosen to match the standard Adobe UI guidelines.">Margins<div class="link-icon '+(i?"active":"")+'" title="Adjust each side individually..."><i class="fas fa-unlock-alt"></i><i class="fas fa-lock-open"></i></div></h2><span class="desc margins-desc '+(i?"hide":"")+'"><span>top</span><span>right</span><span>bottom</span><span>left</span></span><div class="margin-inputs"><input class="number" style="display: none;"><div class="n-1-4"><input data-edit="margins" class="number top" value="'+(i?t:t[0])+'" min="0" max="300" step="1" modifier-step="10"></div><div class="n-3-4 '+(i?"hidden":"")+'"><input data-edit="margins" class="number right" value="'+(i?t:t[1])+'" min="0" max="300" step="1" modifier-step="10"'+(i?"disabled":"")+'><input data-edit="margins" class="number bottom" value="'+(i?t:t[2])+'" min="0" max="300" step="1" modifier-step="10"'+(i?"disabled":"")+'><input data-edit="margins" class="number left" value="'+(i?t:t[3])+'" min="0" max="300" step="1" modifier-step="10"'+(i?"disabled":"")+'></div><input class="number" style="display: none;"></div>');break;case"preferredSize":a=$('<h2 title="The preferred size, used by layout managers to determine the best size for each element. \n\nIf not explicitly set by a script, value is established by the UI framework in which ScriptUI is employed, and is based on such attributes of the element as its text, font, font size, icon size, and other UI framework-specific attributes. A script can explicitly set preferredSize before the layout manager is invoked in order to establish an element size other than the default.">Preferred Size<span class="preferred-size-auto" title="Reset to content size (0)"><i class="fas fa-compress"></i></span></h2><div class="dimensions-container linked"><input class="number" style="display: none;"><h4 class="width-heading">Width:</h4><input class="number width" data-edit="preferredSize" value="'+t[0]+'" min="0" max="2000" step="1" modifier-step="10"><h4 class="height-heading">Height:</h4><input class="number height" data-edit="preferredSize" value="'+t[1]+'" min="0" max="2000" step="1" modifier-step="10"><input class="number" style="display: none;"></div>');break;case"orientation":(a=$('<h2 class="orientation-heading" title="The layout orientation of children in a container.">Orientation</h2><h2 class="spacing-heading" title="The number of pixels separating one child element from its adjacent sibling element. \n\nBecause each container holds only a single row or column of children, only a single spacing value is needed for a container. The default value is based on the type of container, and is chosen to match standard Adobe UI guidelines.">Spacing</h2><br><div class="orientation"><select name="qty" class="pretty-classic" data-edit="orientation"><option>row</option><option>column</option></select></div>')).last().find('option:contains("'+t+'")').prop("selected",!0);break;case"spacing":a=$('<input class="number" style="display: none;"><div class="spacing-container"><input class="number" data-edit="spacing" value="'+t+'" min="0" max="300" step="1" modifier-step="5"></div><input class="number" style="display: none;">');break;case"alignChildren":var n=$("#dialog .active").hasClass("orientation-column");a=$('<h2 title="Tells the layout manager how unlike-sized children of this container should be aligned within a column or row. \n\nOrder of creation determines which children are at the top of a column or the left of a row; the earlier a child is created, the closer it is to the top or left of its column or row. If defined, alignment for a child element overrides the alignChildren setting for the parent container. See alignment property for values.">Align Children</h2><div class="align-children"><span class="x-axis">X:</span><select id="align-children-horizontal" data-edit="alignChildren" name="qty" class="pretty-classic"><option>left</option><option>center</option><option>right</option>'+(n?"<option>fill</option>":"")+'</select><span class="y-axis">Y:</span><select id="align-children-vertical" data-edit="alignChildren" name="qty" class="pretty-classic"><option>top</option><option>center</option><option>bottom</option>'+(n?"":"<option>fill</option>")+"</select></div>");var s=t[0],l=t[1];a.find('#align-children-horizontal option:contains("'+s+'")').prop("selected",!0),a.find('#align-children-vertical option:contains("'+l+'")').prop("selected",!0);break;case"image":a=$('<div class="image-edit"><div class="img-wrapper"><img class="base64-bin" src="'+t[0]+'" alt="" /></div><div class="custom-file-input"><i class="fas fa-upload"></i>Choose file...</div><input data-edit="image" type="file" accept="image/jpeg, image/png"></div>');break;case"alignment":var r,d=$("#dialog .active").parent("div").parent("div").hasClass("orientation-column"),o=d?"column":"row",c=d?"horizontal":"vertical",p=null===t,m=d?["left","center","right","fill"]:["top","center","bottom","fill"],g="";$.each(m,function(e,t){g+='<option value="'+t+'">'+t+"</option>"}),a=$('<div class="alignment-container"><h2 title="The alignment style for this element. If defined, this value overrides the alignChildren setting for the parent container.">Alignment <span>(Self)</span></h2><div class="alignment-checkbox"><input type="checkbox" id="alignment-checkbox-input" name="" '+(p?"":"checked")+' /><label for="alignment-checkbox-input"></label></div><br>'+('<div id="alignment-'+c+'"><select name="qty" class="pretty-classic" data-edit="alignment"  data-edit-value="'+c+'" '+(p?"disabled":"")+" >"+g+"</select></div>")+"</div>"),"column"===o?(r=("top"===t?"left":"bottom"===t&&"right")||t,a.find('#alignment-horizontal option:contains("'+(null===t?"center":r)+'")').prop("selected",!0)):(r=("left"===t?"top":"right"===t&&"bottom")||t,a.find('#alignment-vertical option:contains("'+(null===t?"center":r)+'")').prop("selected",!0));break}return a}},propsPanel=$("#panel-edit-style-wrap");propsPanel.on("click",".justify-icon",function(){$(this).addClass("active").siblings().removeClass("active")}),propsPanel.on("change",".alignment-checkbox input",function(){var e=$(this).prop("checked"),t=!e,a=e?"removeClass":"addClass";$(".alignment-container select").prop("disabled",t).trigger("change"),$(".alignment-container .prettydropdown")[a]("disabled")}),propsPanel.on("click",".preferred-size-auto",function(){var e=propsPanel.find("input.width");e.val(0).change(),propsPanel.find("input.height").val(0).change(),item.funnel.update(e.data("edit"))}),propsPanel.on("dblclick",".number-overlay",function(){var e=$(this).parent().find(".number");e.val(0).change(),item.funnel.update(e.data("edit"))}),propsPanel.on("click",".link-icon",function(){var e=$(".margin-inputs .n-3-4");e.hasClass("hidden")?($(this).removeClass("active"),e.removeClass("hidden"),e.find("input").prop("disabled",!1).val($(".margin-inputs .n-1-4 input").val()),$("#panel-edit-style-wrap .margins-desc").removeClass("hide")):($(this).addClass("active"),e.addClass("hidden"),e.find("input").prop("disabled",!0),$("#panel-edit-style-wrap .margins-desc").addClass("hide")),item.funnel.update("margins")}),propsPanel.on("keydown",'[data-edit="text"]',function(e){return lineBreakIntercept(e)}),propsPanel.on("keyup",'[data-edit="text"]',function(e){18!=(e.keyCode?e.keyCode:e.which)&&item.funnel.update($(this).data("edit"));var t=$("#dialog .active");"EditText"===t.data("item-type")&&t.find(".os-content-glue").html(t.find("[contenteditable]").html());var a=t.find(".text-container"),i=t.data("item-type"),n=a.height(),s=!1;"StaticText"===i&&n>25.5?s=!0:"EditText"===i&&n>22.5&&(s=!0),s?a.addClass("multiline"):a.removeClass("multiline")}),propsPanel.on("keyup",'[data-edit="listItems"], [data-edit="varName"]',function(){if("varName"===$(this).data("edit")){$(this).val($(this).val().replace(/[-]+/g," ").replace(/^[0-9]/g,"").replace(/[^\w\s]/g,"").replace(/ (.)/g,function(e){return e.toUpperCase()}).replace(/ /g,""))}item.funnel.update($(this).data("edit"))}),propsPanel.on("click",'[data-edit="justify"]',function(){item.funnel.update($(this).data("edit"))}),propsPanel.on("change","select[data-edit]",function(){if("orientation"===$(this).data("edit")){var e="column"===$(this).find("option:selected").val(),t=$("#align-children-horizontal"),a=$("#align-children-vertical");e?(a.find("option:contains(fill)").remove(),$("<option>fill</option>").appendTo(t)):(t.find("option:contains(fill)").remove(),$("<option>fill</option>").appendTo(a)),$("#panel-edit-style-wrap .align-children select").each(function(){$(this).trigger("change"),$(this).prettyDropdown({classic:!0,customClass:"arrow triangle",selectedMarker:'<i class="fas fa-check"></i>'}).refresh()})}item.funnel.update($(this).data("edit"))}),propsPanel.on("click",".custom-file-input",function(){propsPanel.find('[data-edit="image"]').trigger("click")}),propsPanel.on("change",'[data-edit="image"]',function(){var e=this.files[0],t={render:function(e,t){var a=new FileReader;a.onload=function(){t(a.result)},a.readAsDataURL(e)},getBinary:function(e,t){var a=new FileReader;a.onload=function(){t(encodeURIComponent(a.result))},a.readAsBinaryString(e)}};t.render(e,function(e){propsPanel.find(".base64-bin").attr("src",e),item.funnel.update("image")})});var snapshot={init:function(){snapshot.fetch_items_length()},openPanel:function(){var e=$('[data-panel="snapshots"]');if(e.data("lock")){e.data({lock:!1});var t=snapshot.fetch_all_items();$(t).prependTo(e.find(".snapshots")),e.find(".take-snapshot").on("click",snapshot.capture),e.on("click",".image",function(){var e=$(this).closest(".snapshot").data("id"),t=local_storage.get("dialog-snapshots").storage["dialog-"+e];modal.init('<img src="'+t.image+'" alt="" />'),$("#modal-window-content").addClass("snapshot-preview")}),e.on("click",".remove",function(){snapshot.remove($(this).closest(".snapshot"))}),e.on("click",".ss-label",function(){snapshot.replace($(this).closest(".snapshot"))})}},replace:function(e){var t=e.data("id"),a=local_storage.get("dialog-snapshots").storage["dialog-"+t],i='<div id="snapshot-replace-box"><img src="'+a.image+'" alt="" /><div class="info-wrap" data-id="'+a.id+'"><span><strong>ID: </strong>'+a.id+"</span><span><strong>Date: </strong>"+new Date(a.date).toLocaleString()+'</span><br><div>Use left and right arrow keys to navigate between snapshots.</div><div>When you load a snapshot it overwrites your current dialog, so you should take a new snapshot first if it has changes you want to keep.</div><div>Sometimes these preview images have some weird clipping errors and such. Just wanted to acknowledge that it can happen, but it doesn\'t carry over to the loaded snapshot.</div></div><div class="btn-wrap"><span class="remove">Delete</span><span class="yes" data-enter>Load this snapshot</span><span class="no">Close</span></div></div>';modal.init(i,"snapshot-replace");var n=$("#snapshot-replace-box");n.find(".yes").on("click",function(){modal.remove(),setTimeout(function(){local_storage.remove("dialog"),local_storage.set("dialog",a.json),modal.remove(),loadingScreen.init(null,function(){location.reload()})},300)}),n.find(".no").on("click",function(){modal.remove()}),n.find(".remove").on("click",function(){var e=$("#modal-window.snapshot-replace .info-wrap").data("id"),t=$('[data-panel="snapshots"] .snapshot[data-id="'+e+'"]');modal.remove(function(){(t.prev().length<1?t.next():t.prev()).find(".ss-label").trigger("click"),snapshot.remove(t)})})},remove:function(e){var t=e.data("id"),a=local_storage.get("dialog-snapshots");delete a.storage["dialog-"+t],e.remove();var i=[];$('[data-panel="snapshots"] .snapshots').children().each(function(){i.push($(this).data("id"))}),a.ids=i.reverse(),local_storage.set("dialog-snapshots",a),snapshot.fetch_items_length()},fetch_items_length:function(){var e=local_storage.get("dialog-snapshots"),t=null;if(e&&e.ids&&(t=e.ids.length),null!==t){var a=$('[data-panel="snapshots"] .label .ss-number');e.ids.length>0?a.html("("+e.ids.length+")"):a.html("")}},fetch_all_items:function(){var e=local_storage.get("dialog-snapshots");null===e&&(e={ids:[],storage:{}},local_storage.set("dialog-snapshots",e));for(var t="",a=e.ids.length;a--;){var i=e.storage["dialog-"+e.ids[a]];t+=snapshot.make_html(i)}return t},capture:function(){var e=$('<div class="snapshot temp"><img src="assets/images/snapshot-load.gif" alt="" /></div>').prependTo('[data-panel="snapshots"] .snapshots'),t=local_storage.get("dialog-snapshots"),a=local_storage.get("dialog"),i=$("#dialog-container");html2canvas(i[0],{backgroundColor:null,logging:!1}).then(function(i){var n=$('[data-panel="snapshots"]');e.remove();var s=t.ids.length>0?Math.max.apply(null,t.ids)+1:1,l=t.storage["dialog-"+s]={};l.id=s,l.date=(new Date).getTime(),l.image=i.toDataURL("image/png"),l.json=a,t.ids.push(l.id),local_storage.set("dialog-snapshots",t);var r=snapshot.make_html(l);n.find('[data-id="'+s+'"]').length<=0&&$(r).prependTo(n.find(".snapshots")),snapshot.fetch_items_length()})},make_html:function(e){var t=new Date(e.date);return'<div class="snapshot" data-id="'+e.id+'"><div class="ss-label"><span title="'+t+'">'+e.id+'</span><div class="text">Snapshot</div></div><div class="icons-wrap animated fadeIn"><div class="remove" title="Remove snapshot..."><i class="fas fa-trash"></i></div></div></div>'}};snapshot.init(),$(document).on("keydown",function(e){if($("#modal-window.snapshot-replace").length>0){var t=e.keyCode?e.keyCode:e.which,a=37===t,i=39===t,n=$("#modal-window.snapshot-replace .info-wrap").data("id");(a||i)&&modal.remove(function(){var e,t=$('[data-panel="snapshots"] .snapshot[data-id="'+n+'"]');a?e=t.next().length<1?t.siblings().first():t.next():i&&(e=t.prev().length<1?t.siblings().last():t.prev()),e.length<1&&(e=t),e.find(".ss-label").trigger("click")})}});var mousemovePing,loadingScreen={init:function(e,t){e=e||.1,$("body").addClass("loading");$('<div id="loader-bg"><div class="loader">Loading...</div></div>').appendTo("body"),$("#loader-bg").backstretch([{url:"./assets/images/bg.jpg",alignX:"center"}]),setTimeout(function(){t()},this.secondsToMilliseconds(e))},secondsToMilliseconds:function(e){return 1e3*e}};setInterval(function(){mousemovePing=!0
},45);var modal={init:function(e,t){modal.make(e,t),$("#modal-window-overlay").on("click",function(){modal.remove()})},make:function(e,t){e=void 0===e?"":e,$('<div id="modal-window" class="'+(t||"")+'"><div id="modal-window-overlay" data-esc></div><div id="modal-window-content" class="animated fadeIn">'+e+"</div></div>").appendTo("body"),$("body").addClass("modal-window-active")},remove:function(e){$("#modal-window-content").addClass("fadeOut"),setTimeout(function(){$("#modal-window").remove(),$("body").removeClass("modal-window-active"),void 0!==e&&e()},100)}};$(document).on("keydown",function(e){if($("#modal-window").length>0){var t=e.keyCode?e.keyCode:e.which,a=13===t;27===t?$("#modal-window").find("[data-esc]").trigger("click"):a&&$("#modal-window").find("[data-enter]").trigger("click")}}),$("#toolbar .export").on("click",function(){modal.init('<div id="export-box"><h2>Export.jsx</h2><div class="code"></div><div class="btns"><div class="download btn animated fadeInDown"><div class="icon"><i class="fas fa-check animated"></i><i class="fas fa-download"></i></div> <span>Download</span></div><div class="copy btn animated fadeInDown"><div class="icon"><i class="fas fa-check animated"></i><i class="fas fa-times animated"></i><i class="fas fa-clipboard-list"></i></div> <span>Copy to Clipboard</span></div></div></div>');var e=CodeMirror($("#export-box .code")[0],{mode:{name:"javascript",json:!0},theme:"monokai",autofocus:!0,lineNumbers:!0,value:exportCode()}),t=$(window).height(),a=$("#export-box"),i=a.height();if(t<i+60){var n=$(window).height()-(i-a.find(".CodeMirror").height());a.find(".code").css({maxHeight:n-160})}clipBoardEvent(e),a.find(".download").on("click",function(){download(exportCode(),"ScriptUI Dialog Builder - Export.jsx","application/javascript");var e=$(this),t=e.find(".fa-check"),a=e.find(".fa-download");t.addClass("rotateIn"),a.hide(),setTimeout(function(){t.removeClass("rotateIn"),a.show()},750)})}),$("#toolbar .import").on("click",function(){var e,t;modal.init('<div id="import-box"><h2>Import.jsx</h2><div class="ta"><div class="placeholder"><span class="important">The current dialog will be overwritten on a successful import.</span> <br><br>You can only import JSON generated by this this tool on export. 3rd line of every export includes the impotable JSON. Your old dialog code written in Javascript will <strong>not</strong> work! <br><br>Valid JSON is beautified (restructured) on paste <br> so that it is easier to read if necessary. <br></br><strong>Paste below</strong> <br><strong>â†“</strong></div><div class="code"></div></div><div data-enter class="import-btn animated infinite"><i class="fas fa-arrow-right"></i><i class="fas fa-times"></i></div></div>'),(t=CodeMirror($("#import-box .code")[0],{mode:{name:"javascript",json:!0},theme:"monokai",autofocus:!0,lineNumbers:!0})).on("change",function(a,i){if("paste"===i.origin)try{var n=t.getValue();e=n;var s=JSON.parse(n),l=JSON.stringify(s,null,3);t.getDoc().setValue(l)}catch(e){}setTimeout(function(){var e=$(window).height(),t=$("#import-box"),a=t.height();if(e<a+60){var i=$(window).height()-(a-t.find(".CodeMirror").height()),n=i-160,s=e<n?i-20:n;t.find(".code").css({maxHeight:s})}},10)}),$("#import-box").find(".import-btn").on("click",function(){var t;try{var a=e.trim();t=JSON.parse(a)}catch(e){}if(void 0===t){var i=$("#import-box");i.find(".fa-arrow-right").hide(),i.find(".import-btn").addClass("tada"),setTimeout(function(){i.find(".fa-arrow-right").show(),i.find(".import-btn").removeClass("tada")},1900)}else local_storage.remove("dialog"),local_storage.set("dialog",t),modal.remove(),loadingScreen.init(null,function(){location.reload()})})}),$("#toolbar .reset").on("click",resetDialog);var bgTimeout,iconTimeout,sampleDialogData='{"activeId":1,"items":{"item-0":{"id":0,"type":"Dialog","parentId":false,"style":{"text":"Import Multiple PDF pages","preferredSize":[0,0],"margins":16,"orientation":"row","spacing":10,"alignChildren":["left","top"]}},"item-1":{"id":1,"type":"Panel","parentId":20,"style":{"text":"Page Selection","preferredSize":[0,205],"margins":10,"orientation":"column","spacing":10,"alignChildren":["left","top"],"alignment":null}},"item-2":{"id":2,"type":"StaticText","parentId":1,"style":{"text":"Import PDF Pages:","justify":"left","preferredSize":[0,0],"alignment":null}},"item-3":{"id":3,"type":"EditText","parentId":6,"style":{"text":"1","preferredSize":[60,0],"alignment":null}},"item-4":{"id":4,"type":"StaticText","parentId":6,"style":{"text":"thru","justify":"left","preferredSize":[0,0],"alignment":null}},"item-5":{"id":5,"type":"EditText","parentId":6,"style":{"text":"1","preferredSize":[60,0],"alignment":null}},"item-6":{"id":6,"type":"Group","parentId":1,"style":{"preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-7":{"id":7,"type":"StaticText","parentId":1,"style":{"text":"Start Placing on Doc Page:","justify":"left","preferredSize":[0,0],"alignment":null}},"item-8":{"id":8,"type":"Checkbox","parentId":1,"style":{"text":"Reverse Page Order","preferredSize":[0,0],"alignment":null}},"item-9":{"id":9,"type":"Panel","parentId":20,"style":{"text":"Sizing Options","preferredSize":[0,160],"margins":10,"orientation":"column","spacing":10,"alignChildren":["left","top"],"alignment":null}},"item-10":{"id":10,"type":"Checkbox","parentId":9,"style":{"text":"Fit to Page","preferredSize":[0,0],"alignment":null}},"item-11":{"id":11,"type":"Checkbox","parentId":9,"style":{"text":"Keep Proportions","preferredSize":[0,0],"alignment":null}},"item-12":{"id":12,"type":"Checkbox","parentId":9,"style":{"text":"Bleed the Fit Page","preferredSize":[0,0],"alignment":null,"checked":true}},"item-13":{"id":13,"type":"StaticText","parentId":9,"style":{"text":"Scale of Imported Page","justify":"left","preferredSize":[0,0],"alignment":null}},"item-14":{"id":14,"type":"Group","parentId":9,"style":{"preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-15":{"id":15,"type":"EditText","parentId":14,"style":{"text":"100","preferredSize":[40,0],"alignment":null}},"item-16":{"id":16,"type":"StaticText","parentId":14,"style":{"text":"Y%:","justify":"left","preferredSize":[0,0],"alignment":null}},"item-17":{"id":17,"type":"EditText","parentId":14,"style":{"text":"100","preferredSize":[40,0],"alignment":null}},"item-18":{"id":18,"type":"StaticText","parentId":14,"style":{"text":"X%:","justify":"left","preferredSize":[0,0],"alignment":null}},"item-19":{"id":19,"type":"Group","parentId":0,"style":{"preferredSize":[0,0],"margins":0,"orientation":"column","spacing":10,"alignChildren":["fill","top"],"alignment":null}},"item-20":{"id":20,"type":"Group","parentId":0,"style":{"preferredSize":[0,0],"margins":0,"orientation":"column","spacing":10,"alignChildren":["fill","top"],"alignment":null}},"item-21":{"id":21,"type":"Panel","parentId":19,"style":{"text":"Positioning Options","preferredSize":[0,205],"margins":10,"orientation":"column","spacing":10,"alignChildren":["fill","top"],"alignment":null}},"item-22":{"id":22,"type":"StaticText","parentId":21,"style":{"text":"Position on Page Aligned From:","justify":"left","preferredSize":[0,0],"alignment":null}},"item-23":{"id":23,"type":"DropDownList","parentId":21,"style":{"text":"","listItems":"Top Left, Top Center, Top Right, Center Left, Center, Center Right, Bottom Left, Bottom Center, Bottom Right, -, Top - Relative to spine,  Center  - Relative to spine,  Right  - Relative to spine","preferredSize":[0,0],"alignment":null,"selection":0}},"item-24":{"id":24,"type":"DropDownList","parentId":21,"style":{"text":"Rotation:","listItems":"0, 90, 180, 270","preferredSize":[0,0],"alignment":null,"selection":0}},"item-25":{"id":25,"type":"StaticText","parentId":21,"style":{"text":"Offset by:","justify":"left","preferredSize":[0,0],"alignment":null}},"item-26":{"id":26,"type":"Group","parentId":21,"style":{"preferredSize":[0,0],"margins":0,"orientation":"row","spacing":10,"alignChildren":["left","center"],"alignment":null}},"item-27":{"id":27,"type":"StaticText","parentId":26,"style":{"text":"X:","justify":"left","preferredSize":[0,0],"alignment":null}},"item-28":{"id":28,"type":"EditText","parentId":26,"style":{"text":"0","preferredSize":[40,0],"alignment":null}},"item-29":{"id":29,"type":"StaticText","parentId":26,"style":{"text":"Y:","justify":"left","preferredSize":[0,0],"alignment":null}},"item-30":{"id":30,"type":"EditText","parentId":26,"style":{"text":"0","preferredSize":[40,0],"alignment":null}},"item-31":{"id":31,"type":"Panel","parentId":19,"style":{"text":"Placement Options","preferredSize":[0,160],"margins":10,"orientation":"column","spacing":10,"alignChildren":["fill","top"],"alignment":null}},"item-32":{"id":32,"type":"DropDownList","parentId":31,"style":{"text":"Crop to:","listItems":"Art, Crop, Trim, Bleed, Media","preferredSize":[0,0],"alignment":null,"selection":0}},"item-33":{"id":33,"type":"Checkbox","parentId":31,"style":{"text":"Place Pages on a New Layer","preferredSize":[0,0],"alignment":null}},"item-34":{"id":34,"type":"Checkbox","parentId":31,"style":{"text":"Ignore Font and Image Errors","preferredSize":[0,0],"alignment":null}},"item-35":{"id":35,"type":"Checkbox","parentId":31,"style":{"text":"Transparent PDF Background","preferredSize":[0,0],"alignment":null,"checked":true}},"item-36":{"id":36,"type":"Group","parentId":0,"style":{"preferredSize":[0,0],"margins":0,"orientation":"column","spacing":10,"alignChildren":["fill","top"],"alignment":null}},"item-37":{"id":37,"type":"Button","parentId":36,"style":{"text":"OK","justify":"center","preferredSize":[0,0],"alignment":null}},"item-38":{"id":38,"type":"Button","parentId":36,"style":{"text":"Cancel","justify":"center","preferredSize":[0,0],"alignment":null}},"item-39":{"id":39,"type":"EditText","parentId":1,"style":{"text":"1","preferredSize":[60,0],"alignment":null}},"item-40":{"id":40,"type":"Checkbox","parentId":1,"style":{"text":"Map to Doc Pages","preferredSize":[0,0],"alignment":null}}},"order":[0,20,1,2,6,3,4,5,8,7,39,40,9,10,11,12,13,14,18,15,16,17,19,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]}';$("#toolbar .sample-dialog").on("click",function(){modal.init('<div id="reset-box"><h2>Sample Dialog.jsx</h2><span class="text">Are you sure you want to <strong>replace</strong> <br>the current dialog with a sample?</span><span class="yes" data-enter>Load Sample</span><span class="no">Cancel</span></div>');var e=$("#reset-box");e.find(".yes").on("click",function(){modal.remove(),setTimeout(function(){local_storage.remove("dialog"),local_storage.set("dialog",JSON.parse(sampleDialogData)),modal.remove(),loadingScreen.init(null,function(){location.reload()})},300)}),e.find(".no").on("click",function(){modal.remove()})}),$(".grey-out-active").on("click",function(){$(this).hasClass("off")?($(this).removeClass("off"),$("#dialog").removeClass("hide-active"),notification("info","Active item highlighted in the dialog preview.",3.5)):($(this).addClass("off"),$("#dialog").addClass("hide-active"),notification("meh","Active item grayed out in the dialog preview.",3.5))}),$('<div id="notifications-wrap"></div>').appendTo("#dialog-overlay-wrap"),$(document).on("keydown",function(e){69==(e.keyCode?e.keyCode:e.which)&&e.altKey&&$(".l-export").trigger("click")}),shortcutExport(),function(){$(".panel-wrap .panel-title, .panel-wrap .collapse, .panel-wrap .label").on("click",function(){var e,t,a;e=$(this),t=e.parent(),a=t.hasClass("collapse")?"removeClass":"addClass",t.hasClass("collapse")&&snapshot.openPanel(),t[a]("collapse"),$("#dialog-section").backstretch("resize")})}();var dangerZone={set:function(e,t){var a=e.dataItem.type,i=e.value,n=i[0],s=i[1],l=0!==n,r=0!==s,d=t,o=Math.round(d.width()),c=Math.round(d.height())-("Dialog"===a?Math.round($("#dialog-title-bar").outerHeight()):0),p=$("#panel-edit-style-wrap"),m=p.find(".number.width"),g=p.find(".number.height"),u="danger-zone";l&&!m.hasClass(u)&&n<o?m.addClass(u):(m.hasClass(u)&&!l||m.hasClass(u)&&n>=o)&&m.removeClass(u),r&&!g.hasClass(u)&&s<c?g.addClass(u):(g.hasClass(u)&&!r||g.hasClass(u)&&s>=c)&&g.removeClass(u)}},forceSize={onUpdate:function(e,t){$("#dialog").find([".static-text",".edit-text",".list-box",".tree-view"].join(", ")).each(function(){var e=$(this),a=e.data("item-id"),i=e.data("item-parent-id"),n={active:t.items["item-"+a],parent:t.items["item-"+i]},s="fill"!==n.parent.style.alignChildren[0],l="fill"!==n.parent.style.alignChildren[1],r=n.active.style.preferredSize[0],d=n.active.style.preferredSize[1],o=0!==r,c=0!==d,p="fill"!==n.active.style.alignment;o&&s&&p?e.width(r):"auto"!==e.width()&&e.width("auto"),c&&l&&p?e.height(d):"auto"!==e.height()&&e.height("auto")})}};$(".panel-wrap").each(function(){$(this).find(".overflow-wrap").overlayScrollbars({})}),$("#dialog-overlay-wrap").overlayScrollbars({className:"os-theme-dark",scrollbars:{visibility:"visible",autoHide:"never"}});var data=local_storage.get("dialog");if(null===data){var params={id:0,type:"Dialog",parentId:!1,target:$("#panel-tree-view-wrap .contents"),event:"load"};item.funnel.create(params)}else{$.inArray(data.activeId,data.order)<0&&data.order.push(data.activeId);var oldActiveId=data.activeId;$.each(data.order,function(e,t){var a=data.items["item-"+t],i=$("#panel-tree-view-wrap"),n={id:t,type:a.type,parentId:a.parentId,target:0===t?i.find(".contents"):i.find('[data-item-id="'+a.parentId+'"] > ul'),event:"loadFromLocalStorage"};item.funnel.create(n)}),$.each(data.order,function(e,t){void 0!==data.items["item-"+t].style.preferredSize&&(item.activate(t),item.update.style.dialogPreview("preferredSize",data,data.items["item-"+t],"loadFromLocalStorage"))}),item.activate(oldActiveId);var oldItem=(data=local_storage.get("dialog")).items["item-"+oldActiveId];edit_style_panel.build(oldItem.style)}var treeElem=$("#panel-tree-view-wrap"),dialog=$("#dialog");$("#panel-tree-view-wrap").on("mouseenter mouseleave",".item-text",function(e){var t=$(this).parent("li"),a=t.data("item-id"),i=dialog.find('[data-item-id="'+a+'"]');"Tab"===t.data("item-type")&&(i=dialog.find('[data-tab-id="'+a+'"]')),"mouseenter"===e.type?i.addClass("ghosting"):i.removeClass("ghosting")}),treeElem.on("click",".item-text",function(){var e=$(this).parent("li").data("item-id");item.activate(e);var t=local_storage.get("dialog");edit_style_panel.build(t.items["item-"+e].style)}),treeElem.on("click",".remove-item",function(){var e=$(this).parent("li").data("item-id");0===e?resetDialog():item.funnel.remove(e)});var treeRootUl=$("#panel-tree-view-wrap .tree-root > ul"),treeDialog=$("#panel-tree-view-wrap .tree-dialog");treeRootUl.sortable({group:"dialog-items",vertical:!0,distance:4,delay:100,tolerance:-3,isValidTarget:function(e,t){var a=tabbedPanel.onDragValid(e,t),i=treeView.onDragValid(e,t);return!a&&!i},onDragStart:function(e,t,a,i){treeDialog.width(treeDialog.width()),e.find(".item-text").length>0?(tab.onStartSort(e),i.altKey&&(e.clone().insertAfter(e).addClass("dolly"),$("body").addClass("duplicate-item"))):t.options.drop||e.clone(!0).insertAfter(e),a(e,t)},onDrop:function(e,t,a){if(treeDialog.width("auto"),t.target.closest("#panel-new-item-wrap").length>0)e.remove();else{var i=e.find(".item-text").length>0,n=$("body").hasClass("duplicate-item");i&&!n?item.drag.sort(e):i&&n?item.drag.duplicate(e,t):item.drag.make(e)}a(e,t)}}),$("#panel-new-item-wrap ul").sortable({drop:!1,group:"dialog-items"}),item.drag={},item.drag.sort=function(e){var t=e.parent("ul").parent("li").data("item-id"),a=e.prev(),i=a.length>0?"insertAfter":"prependTo",n=a.length>0?a.data("item-id"):t;e.attr("item-parent-id",t),e.data({"item-parent-id":t});var s=e.data("item-type"),l=e.data("item-id");item.funnel.sort(l,t,s,i,n),item.activate(l);var r=local_storage.get("dialog");edit_style_panel.build(r.items["item-"+l].style),tab.onSort(e),treeViewItem.onSort(e,s,l)},item.drag.make=function(e){var t=e.prev(),a=e.parent("ul"),i=t.length<1,n=t.data("parent"),s=i?a:t,l={id:item.get.id(),type:e.data("item-type"),parentId:i?a.parent("li").data("item-id"):t.data("item-parent-id"),target:s,previousIsParent:n,event:"drag"};e.remove(),item.funnel.create(l)},item.drag.duplicate=function(e,t){var a=e.prev(),i=e.parent("ul"),n=a.length<1,s=a.data("parent"),l=n?i:a;$("body").removeClass("duplicate-item"),$("#panel-tree-view-wrap .dolly").removeClass("dolly"),e.remove();var r,d=local_storage.get("dialog"),o=$("#panel-tree-view-wrap"),c={};e.find("[data-item-id]").add(e).each(function(e){var a=$(this).data("item-id"),i=d.items["item-"+a],n=item.get.id(),p=0===e?t.target.parent("li").data("item-id"):c["parent-"+i.parentId];$(this).data("parent")&&(c["parent-"+a]=n);var m={id:n,type:i.type,parentId:p,target:0===e?l:o.find('[data-item-id="'+p+'"] > ul'),event:0===e?"drag-duplicate":"loadFromLocalStorage",previousIsParent:s,sourceId:a};0===e&&(r=m.id),item.funnel.create(m)}),item.activate(r);var p=(d=local_storage.get("dialog")).items["item-"+r];edit_style_panel.build(p.style),$("body").removeClass("dragging")};var dialogElem=$("#dialog");dialogElem.on("focus","[contenteditable]",function(){var e=$(this),t=(e.parent().attr("id"),e.hasClass("tab")&&e.data("tab-id")||e.closest("[data-item-id]").data("item-id"));item.activate(t);var a=local_storage.get("dialog");edit_style_panel.build(a.items["item-"+t].style,"dialog")}),dialogElem.on("focus blur",'[data-item-type="EditText"] [contenteditable]',function(e){"focusin"===e.type?$(this).parent().parent().addClass("focused"):dialogElem.find(".focused").removeClass("focused")}),dialogElem.on("click",'[data-item-type="EditText"]',function(e){e.preventDefault(),$(this).find("[contenteditable]").focus()}),dialogElem.on("click",'[data-item-type="Image"]',function(){var e=$(this).data("item-id");item.activate(e);var t=local_storage.get("dialog");edit_style_panel.build(t.items["item-"+e].style)}),dialogElem.on("keydown","[contenteditable]",function(e){return lineBreakIntercept(e)}).on("keyup","[contenteditable]",function(){var e=$('#panel-edit-style-wrap [data-edit="text"]'),t=$(this).html().replace(/<br>$/,"").split("<br>").join("\n");e.html(t);var a=$(this).closest("[data-item-type]").hasClass("static-text"),i=$(this).closest("[data-item-type]").hasClass("edit-text");if(a||i){var n=$(this).height(),s=!1;a&&n>25.5?s=!0:i&&n>22.5&&(s=!0),s?$(this).addClass("multiline"):$(this).removeClass("multiline")}autosize.update(e);item.funnel.update("text","dialog")}).on("paste","[contenteditable]",function(e){e.preventDefault(),notification("meh","Sorry, you can't paste text here. <br> The textarea in Item Properties Panel has been focused, paste there instead.",5.5),$('#panel-edit-style-wrap [data-edit="text"]').focus()}),$("#dialog-title-bar div").on("blur",function(){var e=$(this);e.css({whiteSpace:"normal"}),setTimeout(function(){e.css({whiteSpace:"nowrap"})},.1)});
//# sourceMappingURL=dialog.builder.js.map